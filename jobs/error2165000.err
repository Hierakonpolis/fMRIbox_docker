+ set -e
+ FSLDIR=/usr/share/fsl/5.0
+ export PATH=/usr/lib/ants:.:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/ROBEX:/usr/lib/ants
+ PATH=/usr/lib/ants:.:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/ROBEX:/usr/lib/ants
+ export ANTSPATH=/usr/lib/ants
+ ANTSPATH=/usr/lib/ants
+ export AFNIbinPATH=/usr/local/AFNIbin
+ AFNIbinPATH=/usr/local/AFNIbin
+ PATH=/usr/local/AFNIbin:/usr/lib/ants:.:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/ROBEX:/usr/lib/ants
+ PATH=/usr/share/fsl/5.0/bin:/usr/local/AFNIbin:/usr/lib/ants:.:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/ROBEX:/usr/lib/ants
+ export FSLDIR PATH
+ . /usr/share/fsl/5.0/etc/fslconf/fsl.sh
+++ echo /usr/share/fsl/5.0/bin:/usr/local/AFNIbin:/usr/lib/ants:.:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/ROBEX:/usr/lib/ants
+++ tr : '\n'
+++ grep -v /usr/lib/fsl/
+++ sed 's/:$//'
+++ tr -s '\n' :
++ PATH=/usr/share/fsl/5.0/bin:/usr/local/AFNIbin:/usr/lib/ants:.:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/ROBEX:/usr/lib/ants
+++ echo /.singularity.d/libs
+++ tr : '\n'
+++ grep -v /usr/lib/fsl/
+++ sed 's/:$//'
+++ tr -s '\n' :
++ LD_LIBRARY_PATH=/.singularity.d/libs
++ FSLDIR=/usr/share/fsl/5.0
++ POSSUMDIR=/usr/share/fsl/5.0
++ PATH=/usr/lib/fsl/5.0:/usr/share/fsl/5.0/bin:/usr/local/AFNIbin:/usr/lib/ants:.:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/ROBEX:/usr/lib/ants
++ FSLOUTPUTTYPE=NIFTI_GZ
++ FSLMULTIFILEQUIT=TRUE
++ FSLTCLSH=/usr/bin/tclsh
++ FSLWISH=/usr/bin/wish
++ FSLBROWSER=/etc/alternatives/x-www-browser
++ FSLLOCKDIR=
++ FSLMACHINELIST=
++ FSLREMOTECALL=
++ FSLCLUSTER_MAILOPTS=n
++ export FSLDIR POSSUMDIR PATH FSLMULTIFILEQUIT FSLOUTPUTTYPE FSLTCLSH FSLWISH FSLBROWSER FSLLOCKDIR FSLMACHINELIST FSLREMOTECALL
++ LD_LIBRARY_PATH=/usr/lib/fsl/5.0:/.singularity.d/libs
++ export LD_LIBRARY_PATH
++ '[' -f /home/users/jwardell1/.fslconf/fsl.sh ']'
+ subjectID=000300655084
+ subIDpath=/data/000300655084
++ dirname /data/000300655084
+ subPath=/data
++ date +%s
+ start=1676563844
+ echo 'subIDpath: /data/000300655084'
+ echo 'subPath: /data'
+ echo 'subjectID: 000300655084'
+ acqparams=/data/derivatives/acqparams.txt
+ template=/usr/share/fsl/data/standard/MNI152_T1_2mm_brain.nii.gz
+ templatemask=/usr/share/fsl/data/standard/MNI152_T1_2mm_brain_mask.nii.gz
+ mkdir -p /data/derivatives/000300655084
+ mkdir -p /data/derivatives/000300655084/bias_field
+ mocodir=/data/derivatives/000300655084/motion
+ coregdir=/data/derivatives/000300655084/coregistration
+ normdir=/data/derivatives/000300655084/normalization
+ procdir=/data/derivatives/000300655084/processed
+ anatdir=/data/derivatives/000300655084/anat
+ echo mocodir: /data/derivatives/000300655084/motion
+ echo coregdir: /data/derivatives/000300655084/coregistration
+ echo normdir: /data/derivatives/000300655084/normalization
+ echo procdir: /data/derivatives/000300655084/processed
+ echo anatdir: /data/derivatives/000300655084/anat
+ mkdir -p /data/derivatives/000300655084/coregistration
+ mkdir -p /data/derivatives/000300655084/motion
+ mkdir -p /data/derivatives/000300655084/normalization
+ mkdir -p /data/derivatives/000300655084/processed
+ mkdir -p /data/derivatives/000300655084/anat
+ AFNI_PID=
+ TOPUP_PID=
+ SKULL_PID=405603
+ wait 405603
+ skullstrip /data/000300655084 /data 000300655084 /data/derivatives/000300655084/anat
+ echo 'function skullstrip was called'
+ subIDpath=/data/000300655084
+ subPath=/data
+ subjectID=000300655084
+ anatdir=/data/derivatives/000300655084/anat
+ N4BiasFieldCorrection -d 3 -i /data/000300655084/anat/T1.nii -o /data/derivatives/000300655084/anat/T1.nii
+ echo anatdir /data/derivatives/000300655084/anat
+ echo subjectID 000300655084
+ cd /ROBEX
+ ./ROBEX /data/derivatives/000300655084/anat/T1.nii /data/derivatives/000300655084/anat/T1.nii
+ echo 'finished skullstrip'
+ ANTS_PID=405603
+ wait
+ vrefbrain=T1.nii
+ vrefhead=T1.nii
+ vepi=rest.nii
+ vout=000300655084_rfMRI_v0_correg
+ epi_orig=/data/000300655084/func/rest.nii
+ echo vepi rest.nii
+ echo epi_orig /data/000300655084/func/rest.nii
+ 3dcalc -a0 /data/000300655084/func/rest.nii -prefix /data/derivatives/000300655084/coregistration/rest.nii -expr 'a*1'
++ 3dcalc: AFNI version=AFNI_22.1.14 (Jun 24 2022) [64-bit]
++ Authored by: A cast of thousands
++ Output dataset /data/derivatives/000300655084/coregistration/rest.nii
+ EPI_PID=511912
+ epireg_set /data/derivatives/000300655084/coregistration T1.nii rest.nii 000300655084_rfMRI_v0_correg T1.nii
++ date +%s
+ echo 'funcion epireg_set was called'
+ coregdir=/data/derivatives/000300655084/coregistration
+ vrefbrain=T1.nii
+ vepi=rest.nii
+ vout=000300655084_rfMRI_v0_correg
+ vrefhead=T1.nii
+ echo 'coregdir /data/derivatives/000300655084/coregistration'
+ echo 'vrefbrain T1.nii'
+ echo 'vepi rest.nii'
+ echo 'vout 000300655084_rfMRI_v0_correg'
+ cd /data/derivatives/000300655084/coregistration
+ /usr/share/fsl/5.0/bin/fast -N -o 000300655084_rfMRI_v0_correg_fast T1.nii
+ start=1676563964
+ echo AA
+ 1deval -num 25 -expr t+10
+ echo AAA
+ SCMOCO_PID=511917
+ echo AAAA
+ moco_sc /data/000300655084/func/rest.nii /data/derivatives/000300655084/coregistration/rest.nii 000300655084 rest
+ echo 'waiting for moco and epi'
+ wait 511917
+ echo 'function moco_sc was called'
+ epi_in=/data/000300655084/func/rest.nii
+ ref_vol=/data/derivatives/000300655084/coregistration/rest.nii
+ subjectID=000300655084
+ suffix=rest
+ cd /data/derivatives/000300655084/motion
+ echo 'inside moco function 1 - don'\''t need to pull slice timing from json file, use dataseries.txt'
+ echo 'inside moco fucntion 2 - no need to find place where 0 occurs out of order, FBIRN fine'
+ TR=2
+ echo 'inside moco fucntion 3 - FBIRN I already know the slice timing should be TR=2'
+ 3dDespike -NEW -prefix Despike_rest.nii.gz /data/000300655084/func/rest.nii
++ 3dDespike: AFNI version=AFNI_22.1.14 (Jun 24 2022) [64-bit]
++ Authored by: RW Cox
[7m*+ WARNING:[0m   If you are performing spatial transformations on an oblique dset,
  such as /data/000300655084/func/rest.nii,
  or viewing/combining it with volumes of differing obliquity,
  you should consider running: 
     3dWarp -deoblique 
  on this and  other oblique datasets in the same session.
 See 3dWarp -help for details.
++ Oblique dataset:/data/000300655084/func/rest.nii is 1.753123 degrees from plumb.
++ Input dataset is in short format, but output will be in float format
++ ignoring first 0 time points, using last 162
++ using 162 time points => -corder 5
++ Loading dataset /data/000300655084/func/rest.nii
Image Exception : #22 :: ERROR: Could not open image T1
terminate called after throwing an instance of 'RBD_COMMON::BaseException'
/run/pd_dockerParralelized_fbirn.sh: line 166: 511914 Aborted                 (core dumped) $FSLDIR/bin/fast -N -o ${vout}_fast ${vrefbrain}
++ 23483 voxels in the automask [out of 131072 in dataset]
++ 44110 voxels in the dilated automask [out of 131072 in dataset]
++ Procesing time series with NEW model fit algorithm
++ smash edit thresholds: 3.1 .. 5.0 MADs
 +   [ 3.457% .. 0.072% of normal distribution]
 +   [ 8.839% .. 3.125% of Laplace distribution]
++ start OpenMP thread #0
++ start OpenMP thread #3
++ start OpenMP thread #2
++ start OpenMP thread #1
..................
++ Elapsed despike time =  365ms

++ FINAL: 7145172 data points, 466724 edits [6.532%], 158290 big edits [2.215%]
++ Output dataset ./Despike_rest.nii.gz
+ echo 'inside moco fucntion 4 - removed outliers with despike sucessfully'
+ echo 'inside moco fucntion 5 - no need to timshift'
+ 3dvolreg -verbose -zpad 1 -base /data/derivatives/000300655084/coregistration/rest.nii -heptic -prefix moco_rest -1Dfile 000300655084_motion.1D -1Dmatrix_save mat.000300655084.1D /data/derivatives/000300655084/motion/Despike_rest.nii.gz
++ 3dvolreg: AFNI version=AFNI_22.1.14 (Jun 24 2022) [64-bit]
++ Authored by: RW Cox
[7m*+ WARNING:[0m   If you are performing spatial transformations on an oblique dset,
  such as /data/derivatives/000300655084/coregistration/rest.nii,
  or viewing/combining it with volumes of differing obliquity,
  you should consider running: 
     3dWarp -deoblique 
  on this and  other oblique datasets in the same session.
 See 3dWarp -help for details.
++ Oblique dataset:/data/derivatives/000300655084/coregistration/rest.nii is 1.753123 degrees from plumb.
++ Reading in base dataset /data/derivatives/000300655084/coregistration/rest.nii
++ Oblique dataset:/data/derivatives/000300655084/motion/Despike_rest.nii.gz is 1.753123 degrees from plumb.
++ Reading input dataset /data/derivatives/000300655084/motion/Despike_rest.nii.gz
++ Edging: x=3 y=3 z=2
++ Creating mask for -maxdisp
 + Automask has 24839 voxels
 + 4467 voxels left in -maxdisp mask after erosion
++ Initializing alignment base
++ Starting final pass on 162 sub-bricks: 0..1..2..3..4..5..6..7..8..9..10..11..12..13..14..15..16..17..18..19..20..21..22..23..24..25..26..27..28..29..30..31..32..33..34..35..36..37..38..39..40..41..42..43..44..45..46..47..48..49..50..51..52..53..54..55..56..57..58..59..60..61..62..63..64..65..66..67..68..69..70..71..72..73..74..75..76..77..78..79..80..81..82..83..84..85..86..87..88..89..90..91..92..93..94..95..96..97..98..99..100..101..102..103..104..105..106..107..108..109..110..111..112..113..114..115..116..117..118..119..120..121..122..123..124..125..126..127..128..129..130..131..132..133..134..135..136..137..138..139..140..141..142..143..144..145..146..147..148..149..150..151..152..153..154..155..156..157..158..159..160..161..
++ CPU time for realignment=0 s  [=0 s/sub-brick]
++ Min : roll=-0.131  pitch=-0.052  yaw=-1.218  dS=-0.270  dL=-0.506  dP=-0.298
++ Mean: roll=-0.023  pitch=+0.195  yaw=-0.489  dS=-0.011  dL=-0.184  dP=-0.037
++ Max : roll=+0.118  pitch=+0.688  yaw=+0.054  dS=+0.252  dL=+0.107  dP=+0.095
++ Max displacements (mm) for each sub-brick:
 0.02(0.00) 0.09(0.08) 0.09(0.12) 0.11(0.17) 0.11(0.12) 0.12(0.14) 0.14(0.09) 0.13(0.13) 0.15(0.18) 0.13(0.14) 0.17(0.13) 0.16(0.11) 0.12(0.08) 0.15(0.13) 0.12(0.15) 0.18(0.18) 0.15(0.11) 0.17(0.11) 0.19(0.11) 0.14(0.11) 0.36(0.29) 0.28(0.49) 0.20(0.13) 0.22(0.03) 0.23(0.17) 0.17(0.14) 0.24(0.15) 0.17(0.10) 0.18(0.14) 0.21(0.15) 0.15(0.14) 0.20(0.12) 0.16(0.07) 0.17(0.08) 0.21(0.13) 0.17(0.13) 0.19(0.10) 0.23(0.12) 0.19(0.13) 0.25(0.15) 0.22(0.13) 0.20(0.10) 0.25(0.12) 0.19(0.11) 0.30(0.13) 0.21(0.16) 0.27(0.13) 0.32(0.08) 0.23(0.14) 0.35(0.16) 0.27(0.20) 0.30(0.15) 0.36(0.08) 0.27(0.11) 0.35(0.12) 0.37(0.07) 0.31(0.09) 0.39(0.12) 0.41(0.11) 0.39(0.08) 0.42(0.06) 0.38(0.07) 0.47(0.17) 0.44(0.13) 0.41(0.04) 0.50(0.10) 0.46(0.12) 0.45(0.05) 0.52(0.09) 0.46(0.13) 0.50(0.12) 0.51(0.05) 0.50(0.06) 0.59(0.13) 0.52(0.14) 0.55(0.12) 0.57(0.09) 0.54(0.07) 0.59(0.09) 0.61(0.05) 0.56(0.09) 0.63(0.12) 0.63(0.08) 0.58(0.06) 0.63(0.12) 0.66(0.05) 0.57(0.10) 0.62(0.08) 0.65(0.04) 0.60(0.09) 0.66(0.17) 0.78(0.27) 0.52(0.73) 0.46(0.12) 0.55(0.16) 0.42(0.18) 0.43(0.08) 0.44(0.11) 0.42(0.06) 0.49(0.12) 0.43(0.11) 0.56(0.16) 1.55(1.10) 1.46(0.35) 1.68(0.25) 1.60(0.55) 1.78(0.18) 1.82(0.08) 1.86(0.11) 1.86(0.05) 1.71(0.24) 1.81(0.24) 1.70(0.18) 1.84(0.18) 1.76(0.10) 1.76(0.03) 1.84(0.13) 1.75(0.12) 1.78(0.09) 1.82(0.09) 1.69(0.20) 1.81(0.16) 1.76(0.09) 1.73(0.07) 1.84(0.17) 1.74(0.13) 1.75(0.08) 1.69(0.11) 1.75(0.12) 1.84(0.18) 1.72(0.19) 1.89(0.23) 1.72(0.25) 1.87(0.21) 1.79(0.09) 1.77(0.05) 1.87(0.15) 1.75(0.16) 1.82(0.10) 1.81(0.05) 1.72(0.14) 1.87(0.22) 1.72(0.22) 1.83(0.17) 1.76(0.12) 1.74(0.12) 1.84(0.16) 1.76(0.12) 1.77(0.07) 1.83(0.14) 1.75(0.15) 1.83(0.13) 1.80(0.08) 1.78(0.14) 1.87(0.17) 1.76(0.20) 1.85(0.19) 1.75(0.18) 1.82(0.13) 1.79(0.12) 1.76(0.15) 1.82(0.17)
++ Max displacement in automask = 1.89 (mm) at sub-brick 131
++ Max delta displ  in automask = 1.10 (mm) at sub-brick 102
++ Wrote dataset to disk in ./moco_rest+tlrc.BRIK
+ echo 'inside moco fucntion 6 - motion corrected using 3dvolreg successful'
+ 3dresample -orient RPI -inset moco_rest+orig.HEAD -prefix /data/derivatives/000300655084/motion/000300655084_rfMRI_moco_rest.nii.gz
invalid input dataset <moco_rest+orig.HEAD>
